---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Zheqi Hu"
date: "2/13"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
library(usethis)
use_git_config(user.name = "jessieeeee77", 
               user.email = "huz220@wfu.edu")
```

### Exercise 1
```{r}
staff <- read_csv("data/instructional-staff.csv")
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))
staff_long %>%
  ggplot(aes(x = year, y = value, color = faculty_type)) +
  geom_line()
```
```{r 1}
png(filename="faculty_type.png", width=600, height=400)
staff_long %>%
  ggplot(aes(x = year,
             y = value,
             group = faculty_type,
             color = faculty_type)) +
  labs (x = "year", y = "Amount", title = "hiring by faculty_type", fill = "faculty_type") + 
  geom_line()

```
#Exercise 2
```{r 2}
ggplot(staff_long, aes(y = faculty_type, fill = value)) +
  geom_bar(position = "fill") +
  facet_wrap(. ~ year) +
  scale_x_continuous() +
  labs(title = "hiring by faculty_type",
       x = NULL, y = NULL, fill = NULL) +
  theme(legend.position = "bottom")

png(filename="faculty_type2.png", width=600, height=400)
staff_long %>%
  ggplot(aes(x = year,
             y = value,
             group = faculty_type,
             color = faculty_type)) +
  labs (x = "year", y = "Amount", title = "hiring by faculty_type", fill = "faculty_type") + 
  facet_wrap(. ~ faculty_type) +
  geom_line()

```




### Exercise 3


```{r 3}
fisheries <- read_csv("data/fisheries.csv")
#I think it might be better to show the proportion of the capture vs. aquaculture of fishes in each country, it might look better.


fish<- filter(fisheries, total > 1000000)
fish$PROP <- fish$capture/fish$total
png(filename="fish.png", width=900, height=400)
ggplot(fish,aes(x = country, y = PROP)) +  geom_line() +
  geom_point(position = "identity") 

```
```{r try geom_point}

ggplot(fish,aes(x = country, y = aquaculture)) + 
  geom_point(position = "identity") 

ggplot(fish, aes(x ="country", fill = aquaculture, color=country))+
    geom_bar(width = 1, position = "stack") +
  coord_polar(theta = "y")
```
```{r try pie}
ggplot(fish, aes(x="", y=capture, fill=country)) + 
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
ggplot(fish, aes(x="", y=aquaculture, fill=country)) + 
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
ggplot(fish, aes(x="", y=total, fill=country)) + 
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)

#I think pie charts represent the country difference in capture and aquaculture significantly better.
```
#Exercise 4
```{r 4}

```





Add exercise headings as needed.
